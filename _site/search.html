<!DOCTYPE html>
<html class="no-js">
  <head>
	<meta charset="utf-8">
	<title>Search | hackad blog</title>
	<meta name="description" content="writing about hacking and other technical stuff I guess.">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- CSS -->
	<link rel="stylesheet" href="/assets/css/main.css">

	<!--Favicon-->
	<link rel="shortcut icon" href="//assets/favicon.ico" type="image/x-icon">

	<!-- Canonical -->
	<link rel="canonical" href="/search.html">

	<!-- RSS -->
	<link rel="alternate" type="application/atom+xml" title="hackad blog" href="/feed.xml" />

	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">

	<!-- Google Fonts -->
	
	<link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic" rel="stylesheet" type="text/css">
	

	<!-- KaTeX -->
	

	<!-- Google Analytics -->
	
</head>

  <body>
    <header class="site-header">
	<div class="branding">
		
		<a href="//">
			<img class="avatar" src="//assets/img/avatar.jpg" alt=""/>
		</a>
		
		<h1 class="site-title">
			<a href="//">hackad blog</a>
		</h1>
	</div>
	<nav class="site-nav">
		<ul>
			
			
			
			
			<li>
				<a class="page-link" href="/about/">
					About
				</a>
			</li>
			
			
			
			
			
			
			
			
			
			
			
			<li>
				<a class="page-link" href="/tags.html">
					tags
				</a>
			</li>
			
			
			<!-- Social icons from Font Awesome, if enabled  -->
			














<li>
	<a href="https://github.com/bewniac" title="Follow on GitHub">
		<i class="fab fa-fw fa-github"></i>
	</a>
</li>























<li>
	<a href="https://twitter.com/bewniac" title="Follow on Twitter">
		<i class="fab fa-fw fa-twitter"></i>
	</a>
</li>





<li>
	<a href="https://www.youtube.com/user/securityfest" title="Follow on YouTube">
		<i class="fab fa-fw fa-youtube"></i>
	</a>
</li>




            
            <!-- Search bar -->
            
		</ul>
	</nav>
    
</header>

    <div class="content">
      <article >
  <header style="background-image: url('//')">
    <h1 class="title">Search</h1>
    
  </header>
  <section class="post-content"><div class="search">
    <div id="search-results"></div>
    <p id="not-found" style="display: none">
        No results found.
    </p>
</div>


<script>
  window.store = {
    
      "2019-06-18-swedish-open-html": {
        "title": "Swedish Open!",
        "tags": "hacking, masscan, dns, rdp, portscanning",
        "date": "June 18, 2019",
        "author": "",
        "category": "",
        "content": "Swedish OpenNOTE! The scans are done solely in the purpose of research. Any issues I find have been reported in a responsible manner and no sensitive data is stored. I suggest to all organisations to keep track of their Internet connected services. Scanning their own IP blocks (IPv4 and IPv6). You can reach out to me at twitter @bewniac.DNS udp 53I’m trying to get more into DNS and wanted to do some research on open resolvers in Sweden. First I wanted to get a list of all Swedish registred IP blocks, which is listed here. I haven’t checked it against other lists and it might now be fully complete but for my purpose it’s good enough.So first I want to get all servers running DNS (UDP port 53). I used masscan, which is a really fast Internet port scanner.By setting the rate to 100 000 I can scan the Swedish IP blocks in under five minutes.masscan --rate=100000 -pU:53 -iL se.zone -oA sweden.dns.serversgrep \"open\" sweden.dns.servers | awk '{print $4}' &gt; sweden.dns.ipNext I wanted to find which servers are open resolvers. You can do this by sending a TXT query for “test.openresolver.com” to the nameserver. I wrote a simple python script to do this.#!/usr/bin/python3import dns.resolverimport socketimport sysif len(sys.argv) &lt; 3:\tprint(\"Usage : \" + str(sys.argv[0]) + \" [IP list of DNS servers to check] [output file]\")\texit()f = open(sys.argv[1], \"r\");out = open(sys.argv[2], \"w\")dns.resolver.default_resolver = dns.resolver.Resolver(configure=False)dns.resolver.default_resolver.timeout = 1dns.resolver.default_resolver.lifetime = 1for ip in f:\tprint(\"Trying server: \" + ip);\ttry:\t\tdns.resolver.default_resolver.nameservers = [socket.gethostbyname(ip)]\t\tanswer = dns.resolver.query(\"test.openresolver.com\", \"TXT\")\texcept:\t\tcontinue\tif answer[0]:\t\tout.write(ip)f.close()out.close()Now I got a list with all open DNS resolvers in Sweden. So what can I do with this information?AXFR TransferAXFR is an old method to sync zone files between nameservers. This shouldn’t be possible to do from Internet. In some misconfigurations this unfortunately true and anyone can ask for the zonefile for a specific domain. I ran some tests to check if there was possible to transfer the zonefile.First I did a reverse lookup to see which domain the nameservers are in. They can have multiple domains, but this is just a simple check-up.for ns in `cat sweden.open.resolvers`; do rev=`dig +time=1 +short +answer -x $ns @$ns`; echo $ns\" \"$rev done | tee sweden.open.resolvers.reverseFilter out the top domain and the domain name with the IP address.awk -F'[ ]' 'NF == 3 {print $1\" \"$3}' sweden.open.resolvers.reverse | awk -F'[ .]' '{print $1\".\"$2\".\"$3\".\"$4\" \"$(NF-2)\".\"$(NF-1)}' &gt; sweden.openresolvers.ns.domainLet’s see if zone-transfer is enabled.awk '{print \"dig +time=1 +short -t axfr @\"$1\" \"$2}' sweden.openresolvers.ns.domain &gt; axfr.commandswhile read cmd; do echo $cmd; $cmd; done &lt;axfr.commands &gt; axfr.resultOther findingsWhen I did the reverse lookup I found a lot of A records named asus.router.com, dsldevice.lan, router.lan and other .lan devices which tells me they’re not supposed to be exposed on the internet.RDP tcp 3389On thing about Remote Desktop Protocol (RDP) is that it should never ever be accessible from the Internet. So let see how many RDP servers are running in Sweden accessible to Internet.masscan --rate=100000 -p3389 -iL se.zone -oG RDP/sweden.3389.scanThe result shows there’s almost 2 000 servers running RDP in Sweden.I’m not comfortable to do anything more with this. You could take screen shots of the login screens to gather intel about users. You could start bruteforcing passwords. One extremely bad vulnerability was disclosed this year (2019) called BlueKeep or CVE-2019-0708. It already exists metasploit modules for checking if the system is vulnerable and there will probably be more PoC’s actually exploiting this vulnerability in the wild. Watch out!",
        "url": "///2019/06/18/swedish_open.html"
      }
      
    
  };
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/0.7.1/lunr.min.js"></script>
<script src="//assets/js/search.js"></script>
</section>
</article>

    </div>
    



  </body>
</html>
